---
title: "Investigation of M regions in Pheidole"
author: "Emeline Favreau"
date: "07/01/2021"
output: html_document
---
#### Copyright 2021 Emeline Favreau, Queen Mary University of London.


---
# Objective of analysis

## Analysis steps:
- Obtaining data
- Aim 1: plot length distribution of unique M regions
- Aim 2: match M regions with Blast results



```{r load all the libraries, eval = TRUE, echo = FALSE, include = FALSE}
# get libraries
basic_libraries <- c("ggplot2",
                     "tidyverse")
for (lib in basic_libraries) {
        if (require(package = lib, character.only = TRUE)) {
                print("Successful")
        } else {
                print("Installing")
                install.packages(lib)
                library(lib, character.only = TRUE )
        }
}
```

```{r import data, eval = TRUE, echo = FALSE, include = FALSE}
# table with contig name, start position, end position, length
# file obtained by bedtools intersect after removing P regions with no coverage,
# keep only M regions with some coverage
# text file
unique_region_length_df <- read.table("result/contig-start-end-length.sorted.txt",
                                      header = FALSE)

# table with blast results
# file obtained by blasting xxx against all nr

```


## Aim 1: plot length distribution of unique M regions

```{r aim 1, eval = TRUE, echo = FALSE, include = TRUE}
# perform analysis 
colnames(unique_region_length_df) <- c("chr", "start", "end", "length")

summary(unique_region_length_df$length)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 1.00   10.00   29.00   46.16   64.00 2373.00 

# number of regions longer than 1000: 13
# length(unique_region_length_df$length[unique_region_length_df$length > 1000])

# make a figure 
hist(unique_region_length_df$length)
```

The largest region with only single-queen reads is 2373 bp, which is longer than GP-9 gene as a ballpark figure.

The mean length is 46 bp: most of those unique regions are small and therefore probably not biologically interesting.

## Aim 2: description

```{r aim 2, eval = TRUE, echo = FALSE, include = TRUE}
# perform analysis 
# make a figure 
```

Conclusion

## Aim 3: description

```{r aim 3, eval = TRUE, echo = FALSE, include = TRUE}
# perform analysis 
# make a figure 
```

Conclusion

## Aim 4: description

```{r aim 4, eval = TRUE, echo = FALSE, include = TRUE}
# perform analysis 
# make a figure 
```

Conclusion



```{r record versions of session, eval = TRUE, echo = FALSE, include = FALSE}
# record versions of R and packages here
sessionInfo()
# R version 3.6.3 (2020-02-29)
# Platform: x86_64-apple-darwin15.6.0 (64-bit)
# Running under: macOS Catalina 10.15.4
# 
# Matrix products: default
# BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
# LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
# 
# locale:
# [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base     
# 
# other attached packages:
# [1] forcats_0.5.0   stringr_1.4.0   dplyr_0.8.5     purrr_0.3.4     readr_1.3.1    
# [6] tidyr_1.0.3     tibble_3.0.1    tidyverse_1.3.0 ggplot2_3.3.0  
# loaded via a namespace (and not attached):
#  [1] Rcpp_1.0.4.6     cellranger_1.1.0 pillar_1.4.4     compiler_3.6.3   dbplyr_1.4.3    
#  [6] tools_3.6.3      lubridate_1.7.8  jsonlite_1.6.1   lifecycle_0.2.0  gtable_0.3.0    
# [11] nlme_3.1-147     lattice_0.20-41  pkgconfig_2.0.3  rlang_0.4.6      reprex_0.3.0    
# [16] cli_2.0.2        DBI_1.1.0        rstudioapi_0.11  yaml_2.2.1       haven_2.2.0     
# [21] xfun_0.13        xml2_1.3.2       withr_2.2.0      httr_1.4.1       knitr_1.28      
# [26] fs_1.4.1         generics_0.0.2   vctrs_0.3.0      hms_0.5.3        grid_3.6.3      
# [31] tidyselect_1.1.0 glue_1.4.1       R6_2.4.1         fansi_0.4.1      readxl_1.3.1    
# [36] modelr_0.1.7     magrittr_1.5     scales_1.1.1     backports_1.1.7  ellipsis_0.3.0  
# [41] rvest_0.3.5      assertthat_0.2.1 colorspace_1.4-1 stringi_1.4.6    munsell_0.5.0   
# [46] broom_0.5.6      crayon_1.3.4 
```
