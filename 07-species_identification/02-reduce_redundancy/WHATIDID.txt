# step 2: Depending on the number of sequences you download, 
# you may need to reduce redundancy by running CD-Hit to collapse redundant sequences 
# (I would set this as an overlap of 0.97%).
mkdir 2019-01-23-species-identification 
mkdir input
cd input
mkdir 2019-01-23-raw-bold-sequences
cd 2019-01-23-raw-bold-sequences                     
# how many sequences ? 6407
grep -E ">" 2019-01-23-raw-bold-sequences/phei_fasta.fas | wc -l
mkdir result
cd result
mkdir 2019-01-23-reduce_redundancy
cd result/2019-01-23-reduce_redundancy
mkdir input
cd input
ln -s ../../../input/2019-01-23-raw-bold-sequences/phei_fasta.fas 
cd ..
# run the command to obtain a fasta file of representative sequences
# some sequences that are highly similar will be removed from the output
# To check which sequences went missing, check out the text file of list of clusters
# sequence identity threshold 97
#  word size 10 (as per manual input)
# length of description in .clstr file set to 0, it takes the fasta defline and stops at first space
# memory limit 16000MB
# number of threads 20
tmux new-session -s redundancy
~/bin/cd-hit-v4.6.8-2017-1208/cd-hit-est -i input/phei_fasta.fas -o result/pheidole 
                                         -c 0.97 -n 10 -d 0 -M 16000 -T 20
# under one minute
